version: '3.4'

services:
  products_transpiler:
    build:
      context: ./products
    volumes:
      - ./products:/app
      - ./products/dist:/app/dist
    command: node_modules/typescript/bin/tsc -w --outDir /app/dist --skipLibCheck

  products_server:
    build:
      context: ./products
    volumes:
      - ./products:/app
      - ./products/dist:/app/dist
    command: node_modules/nodemon/bin/nodemon.js -w /app/dist/ /app/dist/index.js
    ports:
      - 3000:3000
    depends_on:
      - products_transpiler
